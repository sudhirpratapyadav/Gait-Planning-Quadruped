digits(32);
l1 = sym(0.04914);
l2 = sym(0.083);
l3 = sym(0.095);
P = [sym(0.12);sym(0.0378);sym(-0.0900)];
t = vpa(sqrt(P(1)^2+P(2)^2));
a1 = vpa(acos(P(1)/t));
P1 =  vpa(l1 * [cos(a1);sin(a1 ); sym(0)]);
u = vpa(P - P1);
r = vpa(sqrt(u(1)^2 + u(2)^2));
s = vpa(sqrt(u(1)^2 + u(2)^2 + u(3)^2));  
v = vpa((l2^2 + s^2 - l3^2) / (2 * l2 * s));
a2 = vpa(acos(v) - acos(r/s));
a3 = vpa(acos((l2^2 + l3^2 - s^2) / (2 * l2 * l3))-pi);
display(rad2deg([a1;a2;a3]));
P1 = vpa(l1 * [cos(a1); sin(a1); sym(0)]);
P2 = vpa(P1 + l2 * [ cos(a1)*cos(a2); sin(a1)*cos(a2) ; sin(a2)]);
P3 = vpa(P2 + l3 * [cos(a1)*cos(a2+a3) ;sin(a1)*cos(a2+a3)  ; sin(a2+a3)]);
display(P3);